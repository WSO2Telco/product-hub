<?xml version="1.0" encoding="UTF-8"?>
<!--
 ~ Copyright (c) 2005-2010, WSO2 Inc. (http://wso2.com) All Rights Reserved.
 ~
 ~ WSO2 Inc. licenses this file to you under the Apache License,
 ~ Version 2.0 (the "License"); you may not use this file except
 ~ in compliance with the License.
 ~ You may obtain a copy of the License at
 ~
 ~    http://www.apache.org/licenses/LICENSE-2.0
 ~
 ~ Unless required by applicable law or agreed to in writing,
 ~ software distributed under the License is distributed on an
 ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 ~ KIND, either express or implied.  See the License for the
 ~ specific language governing permissions and limitations
 ~ under the License.
 -->
<assembly>
    <id>bin</id>
    <formats>
        <format>zip</format>
    </formats>
    <includeBaseDirectory>false</includeBaseDirectory>
    <fileSets>
        <fileSet>
            <!--<directory>target/wso2carbon-core-${carbon.platform.version}</directory>-->
            <!-- zip dir to build -->
            <directory>target/intgw/wso2am-3.2.0</directory>
            <outputDirectory>wso2telcohub-${pom.version}</outputDirectory>
            <excludes>
                <!--<exclude>**/bin/wso2server.sh</exclude>
                <exclude>**/bin/wso2server.bat</exclude>
                <exclude>**/conf/axis2/axis2.xml</exclude>
                <exclude>**/conf/security/Owasp.CsrfGuard.Carbon.properties</exclude-->
		        <exclude>**/log4j.properties</exclude>
                <exclude>**/version.txt</exclude>
                <exclude>**/README.txt</exclude>
                <exclude>**/LICENSE.txt</exclude>
                <exclude>**/release-notes.html</exclude>
                <!--exclude>**/registry.xml</exclude>
                <exclude>**/master-datasources.xml</exclude>-->
                <!--note: to overwrite a file you need to exclude them first -->
                <exclude>**/repository/resources/api_templates/velocity_template.xml</exclude>
                <exclude>**repository/resources/default-tiers/default-app-tiers.xml</exclude>
                <exclude>**repository/resources/default-tiers/default-tiers.xml</exclude>
<!--                <exclude>**repository/deployment/server/jaggeryapps/store/**</exclude>-->
<!--                <exclude>**repository/deployment/server/jaggeryapps/publisher/**</exclude>-->
<!--                <exclude>**/user-mgt.xml</exclude>
                <exclude>**/api-manager.xml</exclude>-->

            </excludes>
        </fileSet>

        <fileSet>
            <directory>target</directory>
            <outputDirectory>wso2telcohub-${pom.version}/repository/components/lib</outputDirectory>
            <includes>
                <include>validator-handler-${com.wso2telco.dep.version}.jar</include>
            </includes>
        </fileSet>

        <!-- audit log handler-->
        <fileSet>
            <directory>target</directory>
            <outputDirectory>wso2telcohub-${pom.version}/repository/components/lib</outputDirectory>
            <includes>
                <include>apim-loghandler-${com.wso2telco.dep.version}.jar</include>
            </includes>
        </fileSet>

<!--        <fileSet>
            <directory>src/main/conf/synapse-configs</directory>
            <outputDirectory>wso2telcohub-${pom.version}/repository/deployment/server/synapse-configs</outputDirectory>
        </fileSet>

  	    <fileSet>
            <directory>src/main/conf/synapse-configs/default/sequences</directory>
            <outputDirectory>wso2telcohub-${pom.version}/repository/resources/apim-synapse-config/</outputDirectory>
        </fileSet>-->

        <!--get all plugins rajith todo - remove 4 additional plugins properly -->
        <fileSet>
            <directory>
                ../../p2-profile/product/target/p2-repo/plugins
            </directory>
            <outputDirectory>wso2telcohub-${pom.version}/repository/components/dropins</outputDirectory>
            <excludes>
                <exclude>dnsjava_2.1.1.wso2v1.jar</exclude>
                <exclude>io.github.openfeign.feign-core_9.3.1.jar</exclude>
                <exclude>io.github.openfeign.feign-jackson_9.3.1.jar</exclude>
                <exclude>libphonenumber_7.4.2.wso2v1.jar</exclude>
            </excludes>
            <includes>
                <include>**/**.jar</include>
            </includes>
        </fileSet>

        <!-- Start WSO2-Telco related changes-->

        <!-- copying telco modules -->
        <fileSet>
            <directory>
                ../../p2-profile/product/target/features/hub-core/modules
            </directory>
            <outputDirectory>wso2telcohub-${pom.version}/modules</outputDirectory>
            <includes>
                <include>**/**</include>
            </includes>
        </fileSet>

	    <!-- api templates -->
	    <fileSet>
            <directory>../resources/api_templates</directory>
            <outputDirectory>wso2telcohub-${pom.version}/repository/resources/api_templates</outputDirectory>
            <includes>
                <include>velocity_template.xml</include>
            </includes>
        </fileSet>

        <!-- API Custom Sequences only custom sequences are copied -->
	    <fileSet>
            <directory>../resources/customsequences</directory>
            <outputDirectory>wso2telcohub-${pom.version}/repository/resources/customsequences</outputDirectory>
            <includes>
                <include>**/**.xml</include>
            </includes>
        </fileSet>

        <!-- start copy wso2-telco webapps -->

        <!-- copy aggregator-blacklist webapp -->
        <fileSet>
            <directory>
                ../../p2-profile/product/target/features/webapps/aggregator-blacklist/generated
            </directory>
            <outputDirectory>${pom.artifactId}-${pom.version}/repository/deployment/server/webapps</outputDirectory>
            <includes>
                <include>aggregator-blacklist.war</include>
            </includes>
        </fileSet>

        <!-- copy blacklist-whitelist-service webapp-->
        <fileSet>
            <directory>
                ../../p2-profile/product/target/features/webapps/blacklist-whitelistservice/generated
            </directory>
            <outputDirectory>${pom.artifactId}-${pom.version}/repository/deployment/server/webapps</outputDirectory>
            <includes>
                <include>blacklist-whitelist-service.war</include>
            </includes>
        </fileSet>

        <!-- copy workflow-service webapp-->
        <fileSet>
            <directory>
                ../../p2-profile/product/target/features/webapps/workflow-service/generated
            </directory>
            <outputDirectory>${pom.artifactId}-${pom.version}/repository/deployment/server/webapps</outputDirectory>
            <includes>
                <include>workflow-service.war</include>
            </includes>
        </fileSet>

        <!-- copy quota-service webapp-->
        <fileSet>
            <directory>
                ../../p2-profile/product/target/features/webapps/quota-service/generated
            </directory>
            <outputDirectory>${pom.artifactId}-${pom.version}/repository/deployment/server/webapps</outputDirectory>
            <includes>
                <include>quota-service.war</include>
            </includes>
        </fileSet>

	<!-- copy activiti webapps  -->
        <fileSet>
            <directory>
                ../../p2-profile/product/target/features/webapps/activiti-explorer/webapps
            </directory>
            <outputDirectory>${pom.artifactId}-${pom.version}/repository/deployment/server/webapps</outputDirectory>
            <includes>
                <include>activiti-explorer.war</include>
            </includes>
        </fileSet>

        <!-- copy ratecard-service webapp-->
        <fileSet>
            <directory>
                ../../p2-profile/product/target/features/webapps/ratecard-service/generated
            </directory>
            <outputDirectory>${pom.artifactId}-${pom.version}/repository/deployment/server/webapps</outputDirectory>
            <includes>
                <include>ratecard-service.war</include>
            </includes>
        </fileSet>

        <!-- copy activiti-rest webapp -->
        <fileSet>
            <directory>
                ../../p2-profile/product/target/features/webapps/activiti-explorer/webapps
            </directory>
            <outputDirectory>${pom.artifactId}-${pom.version}/repository/deployment/server/webapps</outputDirectory>
            <includes>
                <include>activiti-rest.war</include>
            </includes>
        </fileSet>
	
	    <!-- copy manage-service webapp -->
	    <fileSet>
            <directory>
                ../../p2-profile/product/target/features/webapps/manage-service/generated
            </directory>
            <outputDirectory>${pom.artifactId}-${pom.version}/repository/deployment/server/webapps</outputDirectory>
            <includes>
                <include>manage-service.war</include>
            </includes>
        </fileSet>
        <!-- end of telco webapps -->

        <!--copy workflow bar files -->
        <fileSet>
            <directory>
                ../../p2-profile/product/target/features/webapps/activiti-explorer/workflow
            </directory>
            <outputDirectory>${pom.artifactId}-${pom.version}/repository/resources/workflow</outputDirectory>
            <includes>
                <include>ApplicationCreationApprovalWorkflow.bar</include>
                <include>SubscriptionCreationApprovalWorkflow.bar</include>
            </includes>
        </fileSet>

        <!-- Default Tiers -->
        <fileSet>
            <directory>../resources/default-tiers</directory>
            <outputDirectory>wso2telcohub-${pom.version}/repository/resources/default-tiers</outputDirectory>
            <includes>
                <include>**/**.xml</include>
            </includes>
        </fileSet>

        <!-- Start DEP Hub related db-scripts -->
        <fileSet>
            <directory>
                ../../p2-profile/product/target/features/hub-core/sql
            </directory>
            <outputDirectory>wso2telcohub-${pom.version}/dbscripts/dep-hub</outputDirectory>
            <includes>
                <include>**/**</include>
            </includes>
        </fileSet>
        <!--End of DEP Hub related dbscripts -->


<!--        &lt;!&ndash; Start DEP Hub related jaggery apps &ndash;&gt;-->
<!--        <fileSet>-->
<!--            <directory>../../p2-profile/product/target/features/jaggeryapps/store</directory>-->
<!--            <outputDirectory>wso2telcohub-${pom.version}/repository/deployment/server/jaggeryapps/store</outputDirectory>-->
<!--            <includes>-->
<!--                <include>**/**</include>-->
<!--            </includes>-->
<!--        </fileSet>-->

<!--        <fileSet>-->
<!--            <directory>../../p2-profile/product/target/features/jaggeryapps/publisher</directory>-->
<!--            <outputDirectory>wso2telcohub-${pom.version}/repository/deployment/server/jaggeryapps/publisher</outputDirectory>-->
<!--            <includes>-->
<!--                <include>**/**</include>-->
<!--            </includes>-->
<!--        </fileSet>-->
<!--        &lt;!&ndash;End of DEP Hub related jaggery apps &ndash;&gt;-->
    </fileSets>

    <files>

        <file>
            <source>src/main/conf/log4j.properties</source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf</outputDirectory>
            <destName>log4j.properties</destName>
            <filtered>true</filtered>
        </file>
        <file>
            <source>../../../LICENSE.txt</source>
            <outputDirectory>wso2telcohub-${pom.version}</outputDirectory>
            <filtered>true</filtered>
            <fileMode>644</fileMode>
        </file>
        <file>
            <source>../../../README.txt</source>
            <outputDirectory>wso2telcohub-${pom.version}</outputDirectory>
            <filtered>true</filtered>
            <fileMode>644</fileMode>
        </file>
        <file>
            <source>../../../release-notes.html</source>
            <outputDirectory>wso2telcohub-${pom.version}</outputDirectory>
            <destName>release-notes.html</destName>
            <fileMode>644</fileMode>
        </file>

        <!-- todo check -->
        <file>
            <source>../version.txt</source>
            <outputDirectory>wso2telcohub-${pom.version}/bin/</outputDirectory>
            <filtered>true</filtered>
            <fileMode>644</fileMode>
        </file>

<!--        <file>
            <source>src/main/startup-scripts/wso2server.sh</source>
            <outputDirectory>wso2telcohub-${pom.version}/bin/</outputDirectory>
            <filtered>true</filtered>
            <fileMode>755</fileMode>
        </file>

        <file>
            <source>src/main/startup-scripts/wso2server.bat</source>
            <outputDirectory>wso2telcohub-${pom.version}/bin/</outputDirectory>
            <filtered>true</filtered>
            <fileMode>755</fileMode>
        </file>-->


        <!--todo add  application-authentication.xml to wso2telcohub-${pom.version}/repository/conf/identity -->

        <!-- source use to copy one file -->
        <file>
            <source>../../p2-profile/product/target/features/hub-core/conf/master-datasources.xml</source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf/datasources</outputDirectory>
            <destName>master-datasources.xml</destName>
            <fileMode>644</fileMode>
        </file>

<!--        <file>
            <source>../../p2-profile/product/target/features/hub-core/config/axis2.xml</source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf/axis2</outputDirectory>
            <destName>axis2.xml</destName>
        </file>-->

        <file>
            <source>../../p2-profile/product/target/features/hub-core/config/registry.xml</source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf</outputDirectory>
            <destName>registry.xml</destName>
            <fileMode>644</fileMode>
        </file>

<!--        <file>
            <source>../../p2-profile/product/target/features/hub-core/config/api-manager.xml</source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf</outputDirectory>
            <destName>api-manager.xml</destName>
            <fileMode>644</fileMode>
        </file>-->


        <file>
            <source>../../p2-profile/product/target/features/hub-core/config/user-mgt.xml</source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf</outputDirectory>
            <destName>user-mgt.xml</destName>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/config/mediator-conf.properties
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/config/publish-events-data-conf.properties
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/config/oneapi-validation-conf.properties
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/config/MobileCountryConfig.xml
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/config/workflow-extensions.xml
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/resources</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/config/workflow.properties
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/config/workflow-configuration.xml
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>../../p2-profile/product/target/features/hub-core/config/Owasp.CsrfGuard.Carbon.properties</source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf/security</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/config/spendLimit.xml
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/config/super-token-conf.properties
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <!-- default custom sequences -->

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/synapse-configs/sequences/custom_message.xml
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/deployment/server/synapse-configs/default/sequences</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/synapse-configs/sequences/httpHeaderSeq.xml
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/deployment/server/synapse-configs/default/sequences</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/synapse-configs/sequences/WSO2AM--Ext--In.xml
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/deployment/server/synapse-configs/default/sequences</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/synapse-configs/sequences/WSO2AM--Ext--Out.xml
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/deployment/server/synapse-configs/default/sequences</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/synapse-configs/sequences/_auth_failure_handler_.xml
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/deployment/server/synapse-configs/default/sequences</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/synapse-configs/sequences/_throttle_out_handler_.xml
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/deployment/server/synapse-configs/default/sequences</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <file>
            <source>
                ../../p2-profile/product/target/features/hub-core/synapse-configs/sequences/fault.xml
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/deployment/server/synapse-configs/default/sequences</outputDirectory>
            <fileMode>644</fileMode>
        </file>

	<file>
            <source>
                ../../p2-profile/product/target/features/hub-core/config/ip-validation.properties
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf</outputDirectory>
            <fileMode>644</fileMode>
        </file>

	<file>
            <source>
                ../../p2-profile/product/target/features/hub-core/config/noauth-validation.properties
            </source>
            <outputDirectory>wso2telcohub-${pom.version}/repository/conf</outputDirectory>
            <fileMode>644</fileMode>
        </file>

        <!--todo  extract the features and move to relevant locations  -->
        <!--
                     registry.xml
        -->
        <!--End of DEP Hub related configs -->

    </files>
</assembly>
